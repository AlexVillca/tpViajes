@if(logueado){
@if(visible){
<div class="popup-overlay"></div>
<div class="popup-content">

  <h3>Guardar en colecci√≥n</h3>

  <form [formGroup]="formulario" (ngSubmit)="saveSelection()">
    <div formArrayName="items">
      <div *ngFor="let item of itemsArray.controls; let i = index">
        <div [formGroupName]="i">
          <label><input type="checkbox" formControlName="seleccionada"  />{{ item.value.nombre }}</label>

        </div>

      </div>


    </div>
    <div class="agregar">
      <input type="text"class="" formControlName="nuevoItem" placeholder="Nueva lista"  maxlength="20"/>
      <button  type="button"  class="button-agregar" (click)="agregarNuevaLista()">Agregar</button>

    </div>
    <small *ngIf="alertaMax"    class="error">Se ha llegado al maximo de listas</small>
    <div class="container">
      <button (click)="closePopup()">Cancelar</button>
      <button type="submit">Guardar cambios</button>
    </div>

  </form>


</div>
}@else{
<button (click)="visible=true">Guardar</button>
}

}
